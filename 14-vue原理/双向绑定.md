[TOC]



# 01

> > 核心是通过Object.defineProperty()对data的每个属性进行了get,set的拦截

## Object.defineProperty()

> 使用Object.defineProperty() 可以通过数据劫持实现一个简单一对一的双向绑定关系，但是效率及其低，所以需要观察者模式

```js
Object.defineProperty() 是ES5的语法

-- 参数：
# 1：要检测的对象
# 2： 该对象中的属性
# 3：是被操作的属性的特性，这个参数的格式是对象
	+ 一般是两个属性：get:function(){}, //读取时触发
        				set:function(){} //写入时触发
```

### 实现双向绑定的条件

1. 实现一个数据对象Observer,能够对数据对象的所有属性进行监听

   ```js
   1.使用Object.defineProperty()监听了每个至的变化，那么监听到变化之后就是怎么通知订阅者了
   2.实现一个消息订阅器，维护一个数组，用来收集订阅者，数据变动触发notify,在调用订阅者的update方法。
   3.
   ```

2. 实现一个指令解析器Compile,对每个元素节点的指令进行扫描和解析，根据指令模板替换数据,已经绑定相应的更新函数

3. 实现一个Watcher作为连接Obsesrver和Compile的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应的回调函数，从而更新试图

4. mvvm入口函数，整合以上 三者



## 观察者模式

> 它可以使双向绑定更有效率，没有也可以实现双向绑定，它是一对多的模式

+ 比如在vue中修改了某一个data数据，页面中凡是用了这个数据的地方，都会更新，这就是页面中的很多地方都观察着这个data,这就是一对多的关系，所以用观察者模式会提高效率。