# ajax02

## 机器人案例

+ 需求:

    1. 把用户说的内容渲染到页面并发送给服务器,服务器返回机器人的回复
    2. 把服务器返回的数据渲染到页面并再次发送给服务器，服务器返回一条语音数据
    3. 把语音数据渲染到网页

+ 步骤
  1. 导入样式布局，调用封装好的滚动条。
  2. 给发送按钮绑定点击事件，然后获取用户输入的内容，把它发送给  服务器接口 并渲染到页面，然后将服务器返回的内容渲染到页面。
  3. 再次将服务器返回的内容 发送 到语音接口，服务器会返回一条语音数据，将语音展示到页面

+ 接口

    > http://www.liulongbin.top:3006

    1. 获取机器人回应的内容

       - 接口URL：  /api/robot
       - 调用方式： GET

       | 参数名称 | 参数类型 | 是否必选 | 参数说明                         |
       | -------- | -------- | -------- | -------------------------------- |
       | spoken   | String   | 是       | 用户输入的内容(要跟机器人说的话) |

    2. 将文字转语音

       - 接口URL：  /api/synthesize
       - 调用方式： GET
       - 参数格式：

       | 参数名称 | 参数类型 | 是否必选 | 参数说明 |
       | -------- | -------- | -------- | -------- |
       | text     | String   | 是       |          |

    

    

    

## 表单相关操作

1. form标签可使用按钮提交，input中的sumbit和button按钮有默认提交行为,input的button没有默认提交行为
2. form的默认提交方式是GET
3. form默认提交会刷新页面
4. form常用的输入域input
5. 输入域中的name属性是必要的，且严格和后台相同

```js
<form>  method="提交方式"  get,post
		action="提交路径"	
        target="打开新页面"	_self _back
        enctype =""	默认是application/x-www-form-urlencoded
        			如果需要文件上传要修改:multipart/form-data
    <progress value="50" max="100"> //进度条标签，value是百分之多少，max是最大
</form>
```



## 基于ajax的提交

### 使用sumbit事件提交

```js
$('form').submit(function(e){ //submit事件，当表单提交时触发
    e.preventDefault() //阻止表单的默认行为
})
```

### 使用点击事件提交

+ 这种方法使用input的按钮也可以使用

```js
$('#btn').click(function(e){ //submit事件，当表单提交时触发
   var formData =	$('form').serialize()	//使用serialize()获取所有表单输入域的数据,输入域必须有name
})
```



## 案例

需求：1.获取评论列表，且渲染到页面

​	   2.点击发表评论，提交数据

```js
reset() //是原生方法,重置表单
```

## 模板引擎

+ 使用模板引擎，可读性会变好，方便后期维护

+ art-template库

+ template-web 是浏览器渲染，npm install art-template --save 是服务端渲染

+ 使用: 

  ```js
  //1.导入库
  //2.定义script标签	
  <script type='text/html' id="自定义">
      {{@b}} //带@可以把标签的模板解析出来
      
      {{if s == 1}}	//1.条件渲染
  	{{else}}
       
       {{each 数据名}}//2.循环
           {{$index}}//属性
           {{$value}}
       {{/each}}
  
     
         {{hh || d}} //使用过滤器
  </script>
         
   <script> 
      //定义过滤器,
       template.defaults.imports.formatDate = function(d){
      	//对原始的日期对象格式化
           return d
       }
  	//定义过滤器
  template.defaults.imports.formatStr = function(str){
      //截取字符串首字母并转为大写
      var s = str.substring(0,1).toUpperCase()
      return str
  }
           
   </script>
         
         
  //3.准备数据
       
  //4.把数据填充到模板中
  	var temp = template('id名'，数据)//参数1是 模板的id,参数2是模板需要的数据，返回值是一个静态的html标签片段
      ul.innerHTML = temp
       
  
  ```

  

  ## 回调函数

  + 函数的特性
    1. 函数是一个对象。
    2. 函数可以存储在变量中
    3. 函数可以做为函数的参数传递。
    4. 函数可以在函数内部创建
    5. 函数可以在函数中返回
  + 回调函数的作用
    + js代码会从上到下一行行执行，但有时候我们需要等到一个特定的操作结束后，再去执行下一个操作，这时候就需要回调函数
  + 回调函数的具体定义：
    + 当函数b作为参数传入函数a中，且a内部执行b，那么这个b就是回调函数

  ```js
  //高阶函数：如果一个函数的参数是函数，且返回值是函数，那么该函数就是高阶函数
  function fun(fun2,value){
  	fun2(value)
  }
  function fun2(a){ 
      console.log(a) //123
  }
  
  fun(fun2,123)
  ```

  

  ## new知识点

  1. 进度条标签

     ```html
      <progress value="50" max="100"> 
      //进度条标签，value是百分之多少，max是最大
     ```

     

  

  

  ## ?

  1. attribute和properties？
  2. prop() 和 attr()？

  

  









